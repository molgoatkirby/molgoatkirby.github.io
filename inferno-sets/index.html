<!DOCTYPE html>

<html lang="en">
	<head>
		<title>Inferno Sets Tool!</title>
		<style>
			#map{
				border:1px solid black;
				display:inline-block;
			}
		</style>
	</head>
	<body>
		<h1>Inferno Sets Tool!</h1>
		<label for="minutes">Minutes left:</label>
		<input type="number" id="minutes" name="minutes">
		<label for="seconds">Seconds left:</label>
		<input type="number" id="seconds" name="seconds">
		<button onclick="drawUpdate()">update</button>
		<br><br>
		<canvas id="map" onselectstart="return false" oncontextmenu="return false" width="580" height="200"></canvas>
		<script>
			var can = document.getElementById("map");
			var selected = [,];
			var size = 20;
			var ctx = can.getContext("2d");
			var fillerTop = 100;

			document.getElementById("map").addEventListener('mousedown',function(e){
				var x = e.offsetX;
				var y = e.offsetY;
				//document.getElementById("minutes").value = x;
				//document.getElementById("seconds").value = y;
				
				if (y >= fillerTop) {
					x = Math.floor(x/size);
					y = y - fillerTop;
					y = Math.floor(y/size);
					selected[0] = x;
					selected[1] = y;
					document.getElementById("minutes").value = x;
					document.getElementById("seconds").value = y;
					if (checkBounds(selected[0],selected[1])) {
						drawUpdate();
					}
				}
			});
			function checkBounds(x,y) {
				if (x > 0 && x < 28 && (y == 0 || y == 4)) {return true;}
				if (y > 0 && y < 4 && (x == 1 || x == 27)) {return true;}
				return false;
			}

			function drawUpdate() {
				ctx.globalAlpha = 1;
				//ctx.clearRect(0,100,can.width,can.height - 100);

				for (var i=1; i<144; i++) {
					if (i < 28 || i > 116 || i%29 == 27 || i%29 == 1) {
						ctx.fillStyle = "black";
						ctx.fillRect(i%29*size, Math.floor(i/29)*size+fillerTop,size,size)
						ctx.fillStyle = "red";
						if (selected[0] == i%29 && selected[1] == Math.floor(i/29)) {
							ctx.fillStyle	= "green";
						}
						ctx.fillRect(i%29*size+1,Math.floor(i/29)*size+1+fillerTop,size-2,size-2)

					}
				}

			}
		</script>
	</body>
</html>
